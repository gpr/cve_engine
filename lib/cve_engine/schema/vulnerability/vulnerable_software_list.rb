module CveEngine
  module Schema
    module Vulnerability
      require 'roxml'

      require 'cve_engine/schema/cpe-language/name_pattern'

      # <xsd:complexType name="vulnerableSoftwareType">
      #   <xsd:sequence>
      #     <xsd:element name="product" type="cpe-lang:namePattern" minOccurs="1" maxOccurs="unbounded"/>
      #   </xsd:sequence>
      # </xsd:complexType>
      class VulnerableSoftwareType
        include ROXML
        xml_namespace 'vuln'
        xml_reader(:products, as: [], from: 'product') {|arr| arr.map {|val| CpeLanguage::NamePattern.new(val) }}

        def to_s
          str = ''

        end
      end
    end
  end
end